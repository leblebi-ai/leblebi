## Acceptance Criteria
- [ ] Export options: Copy as JSON, Generate shareable link, Export as QR code
- [ ] JSON export excludes API keys and personal data
- [ ] Shareable link generation (if community hub enabled)
- [ ] QR code for mobile-to-mobile sharing
- [ ] Import via: paste JSON, scan QR, open shared link
- [ ] All entities generated using ZFA (Zorphy) with JSON serialization
- [ ] All Clean Architecture layers generated using ZFA generate command
- [ ] State management using ZFA-generated State classes

## Task
Implement the Export Agent feature for sharing agent configurations.

### Export Options:

**Entry Point:**
Agent card context menu â†’ "Share" or Agent Profile Editor â†’ "Share Agent"

**Share Sheet:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  Share Agent                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Sharing "Email Agent"              â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“‹ Copy as JSON              â”‚   â”‚
â”‚  â”‚ Copy config to clipboard     â”‚   â”‚
â”‚  â”‚ (API keys excluded)          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ”— Generate Shareable Link   â”‚   â”‚
â”‚  â”‚ Create a link to share       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“± Export as QR Code         â”‚   â”‚
â”‚  â”‚ Scan to import on mobile     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸŒ Publish to Community      â”‚   â”‚
â”‚  â”‚ Share with other users       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Copy as JSON:

**Process:**
1. User taps "Copy as JSON"
2. Agent configuration serialized to JSON
3. Sensitive data excluded (API keys, personal info)
4. JSON copied to clipboard
5. Toast confirmation: "Agent config copied to clipboard"

**JSON Structure:**
```json
{
  "version": "1.0",
  "type": "agent",
  "exportedAt": "2024-02-11T14:30:00Z",
  "agent": {
    "name": "Email Agent",
    "description": "Manages email inbox and drafts",
    "avatar": {
      "type": "emoji",
      "value": "ğŸ“§"
    },
    "model": {
      "provider": "openai",
      "model": "gpt-4",
      "temperature": 0.7,
      "maxTokens": 4000
    },
    "systemPrompt": "You are an email management assistant...",
    "tools": ["web_search", "email_access"],
    "permissions": {
      "level": "ask_critical"
    },
    "memory": {
      "enabled": true,
      "contextWindow": 20
    }
  },
  "metadata": {
    "sourceApp": "Leblebi",
    "sourceVersion": "1.0.0"
  }
}
```

**Excluded Data:**
- API keys
- User email/account info
- Chat history
- Conversation memories
- Internal IDs
- Timestamps (except export date)

### Generate Shareable Link:

**Prerequisites:**
- Community hub must be enabled
- User must be signed in (optional, for tracking)

**Process:**
1. User taps "Generate Shareable Link"
2. Configuration uploaded to cloud
3. Unique URL generated
4. URL copied to clipboard
5. Share dialog appears

**Link Format:**
```
https://leblebi.app/agents/share/a1b2c3d4e5f6
```

**Share Dialog:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  Shareable Link Created          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Link generated successfully!       â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ https://leblebi.app/agents/  â”‚   â”‚
â”‚  â”‚ share/a1b2c3d4e5f6          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  [ğŸ“‹ Copy]                         â”‚
â”‚                                     â”‚
â”‚  Link expires: Never               â”‚
â”‚  (or configurable: 7 days, 30 days)â”‚
â”‚                                     â”‚
â”‚  Share via:                         â”‚
â”‚  [Message] [Email] [More...]        â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚        Done              â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Link Settings:**
- Expiration: Never, 7 days, 30 days, Custom
- Password protection (optional)
- Download limit (optional)
- Analytics tracking (optional)

### Export as QR Code:

**Process:**
1. User taps "Export as QR Code"
2. Agent config compressed and encoded
3. QR code generated
4. Full-screen QR display

**QR Code Display:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  Scan to Import                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Scan this QR code with another     â”‚
â”‚  Leblebi app to import this agent.  â”‚
â”‚                                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚         â”‚ â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ â”‚          â”‚
â”‚         â”‚ â–“ â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â–“ â”‚          â”‚
â”‚         â”‚ â–“ â”‚   â”‚ â”‚   â”‚ â–“ â”‚          â”‚
â”‚         â”‚ â–“ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â–“ â”‚          â”‚
â”‚         â”‚ â–“ â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ â–“ â”‚          â”‚
â”‚         â”‚ â–“ â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â–“ â”‚          â”‚
â”‚         â”‚ â–“ â”‚       â”‚   â–“ â”‚          â”‚
â”‚         â”‚ â–“ â””â”€â”€â”€â”€â”€â”€â”€â”˜   â–“ â”‚          â”‚
â”‚         â”‚ â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ â”‚          â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                     â”‚
â”‚  Agent: Email Agent                 â”‚
â”‚                                     â”‚
â”‚  [Save to Photos] [Share Image]     â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**QR Code Options:**
- Save to photos
- Share image
- Print
- Increase size (for small configs, might be complex)

**Data Compression:**
- JSON minified
- Gzip compression
- Base64 encoding
- QR code error correction level: M (15% recovery)

### Publish to Community:

**Prerequisites:**
- User must be signed in
- Community hub enabled

**Publish Flow:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  Publish to Community            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Publishing "Email Agent"           â”‚
â”‚                                     â”‚
â”‚  Template Name                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Email Agent                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  Description                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Efficiently manage your inboxâ”‚   â”‚
â”‚  â”‚ with automated triage and    â”‚   â”‚
â”‚  â”‚ smart reply drafting.        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  Category                           â”‚
â”‚  [Productivity              â–¼]      â”‚
â”‚                                     â”‚
â”‚  Tags (optional)                    â”‚
â”‚  [email, productivity, automation]  â”‚
â”‚                                     â”‚
â”‚  License                            â”‚
â”‚  â— MIT (Free to use)                â”‚
â”‚  â—‹ Custom                           â”‚
â”‚                                     â”‚
â”‚  â˜‘ I confirm this doesn't contain  â”‚
â”‚     sensitive or malicious content  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   Submit for Review       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Review Process:**
1. Submitted templates enter review queue
2. Community moderators review
3. Approved templates appear in Community tab
4. User notified of approval/rejection
5. Analytics available for published templates

### Import Agent:

**Import Methods:**

**1. Paste JSON:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  Import Agent                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Paste agent configuration:         â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ {                            â”‚   â”‚
â”‚  â”‚   "version": "1.0",          â”‚   â”‚
â”‚  â”‚   "type": "agent",           â”‚   â”‚
â”‚  â”‚   "agent": {                 â”‚   â”‚
â”‚  â”‚     ...                      â”‚   â”‚
â”‚  â”‚   }                          â”‚   â”‚
â”‚  â”‚ }                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚     Import Agent          â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**2. Scan QR Code:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  Scan QR Code                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                              â”‚   â”‚
â”‚  â”‚     [Camera Preview]         â”‚   â”‚
â”‚  â”‚                              â”‚   â”‚
â”‚  â”‚     Align QR code here       â”‚   â”‚
â”‚  â”‚                              â”‚   â”‚
â”‚  â”‚                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  Point camera at a Leblebi agent   â”‚
â”‚  QR code to import.                â”‚
â”‚                                     â”‚
â”‚  [Enter Code Manually]              â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**3. Open Shared Link:**
- User clicks link in browser
- Deep link opens app
- Template preview displayed
- Option to import or view in marketplace

**Import Preview:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  Import Agent                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  ğŸ“§ Email Agent                     â”‚
â”‚                                     â”‚
â”‚  Description:                       â”‚
â”‚  Efficiently manage your inbox with â”‚
â”‚  automated triage and smart reply   â”‚
â”‚  drafting.                          â”‚
â”‚                                     â”‚
â”‚  Configuration:                     â”‚
â”‚  â€¢ Model: GPT-4                     â”‚
â”‚  â€¢ Tools: Web Search, Email Access  â”‚
â”‚  â€¢ Temperature: 0.7                 â”‚
â”‚                                     â”‚
â”‚  âš ï¸ Missing Requirements:           â”‚
â”‚  â€¢ Email account not connected      â”‚
â”‚                                     â”‚
â”‚  Import as:                         â”‚
â”‚  â— New agent                        â”‚
â”‚  â—‹ Replace existing agent           â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚     Import Agent          â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### State Management:

**Export Data:**
```javascript
{
  format: enum, // json, link, qr, community
  agentId: string,
  shareSettings: {
    expiration: Date | null,
    password: string | null,
    downloadLimit: number | null
  },
  publishedTemplate: {
    id: string,
    status: enum, // draft, pending, approved, rejected
    publishedAt: Date | null
  }
}
```

### Security Considerations:
- Never export API keys
- Sanitize system prompts of personal info
- Validate imported JSON structure
- Warn about potentially malicious imports
- Rate limit share link generation

## ZFA Architecture Requirements

### Entity Definition

Uses existing **Agent** entity (UC-1.2).

**SharedAgent Entity:**
```bash
zfa entity create -n SharedAgent --field "id:String,agentId:String,shareLink:String?,qrCodeData:String?,expiresAt:DateTime?,downloadCount:int,createdAt:DateTime" --json
```

### Clean Architecture Generation

```bash
zfa generate SharedAgent --methods=get,getList,create,delete --data --vpc --state
```

### Implementation Notes

1. **Export JSON**: Use `Agent.toJson()` but exclude sensitive fields
2. **Share Link**: Generate unique ID, store in `SharedAgent`, create link
3. **QR Code**: Compress JSON, encode as QR data URL

