## Acceptance Criteria
- [ ] Same export options as agent export (JSON, link, QR)
- [ ] Includes full workflow graph structure
- [ ] Option to include or exclude agent configurations
- [ ] Import workflow from JSON or shared link
- [ ] Workflow preview before import
- [ ] All entities generated using ZFA (Zorphy) with JSON serialization
- [ ] All Clean Architecture layers generated using ZFA generate command
- [ ] State management using ZFA-generated State classes

## Task
Implement the Export Workflow feature for sharing workflow configurations.

### Export Options:

**Entry Point:**
Workflow builder â†’ "Share" button or Workflow list â†’ context menu â†’ "Share"

**Share Sheet:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  Share Workflow                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Sharing "Email Triage"             â”‚
â”‚                                     â”‚
â”‚  Include Agent Configurations?      â”‚
â”‚  â— Include (complete setup)         â”‚
â”‚  â—‹ Exclude (structure only)         â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“‹ Copy as JSON              â”‚   â”‚
â”‚  â”‚ Copy workflow to clipboard   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ”— Generate Shareable Link   â”‚   â”‚
â”‚  â”‚ Create a link to share       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“± Export as QR Code         â”‚   â”‚
â”‚  â”‚ Scan to import on mobile     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸŒ Publish to Community      â”‚   â”‚
â”‚  â”‚ Share with other users       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Include vs Exclude Agents:

**Include Agent Configurations:**
- Complete workflow setup
- All agent configurations included
- Larger export size
- Recipient gets ready-to-run workflow

**Exclude Agent Configurations:**
- Structure only (nodes and connections)
- Agent nodes show placeholder
- Smaller export size
- Recipient must configure agents

**Comparison:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Export Options                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â— Include Agent Configurations     â”‚
â”‚    â€¢ Complete ready-to-run workflow â”‚
â”‚    â€¢ Recipient doesn't need setup   â”‚
â”‚    â€¢ Larger file size               â”‚
â”‚    â€¢ May contain sensitive prompts  â”‚
â”‚                                     â”‚
â”‚  â—‹ Exclude Agent Configurations     â”‚
â”‚    â€¢ Structure only                 â”‚
â”‚    â€¢ Recipient configures agents    â”‚
â”‚    â€¢ Smaller file size              â”‚
â”‚    â€¢ No sensitive data              â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Workflow JSON Structure:

**With Agent Configurations:**
```json
{
  "version": "1.0",
  "type": "workflow",
  "exportedAt": "2024-02-11T14:30:00Z",
  "includeAgents": true,
  "workflow": {
    "name": "Email Triage",
    "description": "Automatically triage emails and draft replies",
    "nodes": [
      {
        "id": "node-1",
        "type": "trigger",
        "position": { "x": 100, "y": 200 },
        "config": {
          "triggerType": "email",
          "folder": "inbox"
        }
      },
      {
        "id": "node-2",
        "type": "agent",
        "position": { "x": 300, "y": 200 },
        "config": {
          "agentId": "email-classifier",
          "agentConfig": {
            "name": "Email Classifier",
            "model": { "provider": "openai", "model": "gpt-4" },
            "systemPrompt": "Classify emails by priority...",
            "tools": []
          }
        }
      },
      {
        "id": "node-3",
        "type": "agent",
        "position": { "x": 500, "y": 200 },
        "config": {
          "agentId": "reply-drafter",
          "agentConfig": {
            "name": "Reply Drafter",
            "model": { "provider": "openai", "model": "gpt-4" },
            "systemPrompt": "Draft professional email replies...",
            "tools": []
          }
        }
      },
      {
        "id": "node-4",
        "type": "approval",
        "position": { "x": 700, "y": 200 },
        "config": {
          "message": "Review and approve reply draft"
        }
      },
      {
        "id": "node-5",
        "type": "output",
        "position": { "x": 900, "y": 200 },
        "config": {
          "outputType": "email",
          "action": "send"
        }
      }
    ],
    "connections": [
      { "source": "node-1", "target": "node-2" },
      { "source": "node-2", "target": "node-3" },
      { "source": "node-3", "target": "node-4" },
      { "source": "node-4", "target": "node-5" }
    ]
  },
  "metadata": {
    "sourceApp": "Leblebi",
    "sourceVersion": "1.0.0",
    "nodeCount": 5,
    "agentCount": 2
  }
}
```

**Without Agent Configurations:**
```json
{
  "version": "1.0",
  "type": "workflow",
  "exportedAt": "2024-02-11T14:30:00Z",
  "includeAgents": false,
  "workflow": {
    "name": "Email Triage",
    "description": "Automatically triage emails and draft replies",
    "nodes": [
      {
        "id": "node-1",
        "type": "trigger",
        "position": { "x": 100, "y": 200 },
        "config": {
          "triggerType": "email",
          "folder": "inbox"
        }
      },
      {
        "id": "node-2",
        "type": "agent",
        "position": { "x": 300, "y": 200 },
        "config": {
          "placeholder": "Classifier Agent",
          "requiredCapabilities": ["email classification"]
        }
      },
      {
        "id": "node-3",
        "type": "agent",
        "position": { "x": 500, "y": 200 },
        "config": {
          "placeholder": "Drafting Agent",
          "requiredCapabilities": ["email composition"]
        }
      },
      {
        "id": "node-4",
        "type": "approval",
        "position": { "x": 700, "y": 200 },
        "config": {
          "message": "Review and approve reply draft"
        }
      },
      {
        "id": "node-5",
        "type": "output",
        "position": { "x": 900, "y": 200 },
        "config": {
          "outputType": "email",
          "action": "send"
        }
      }
    ],
    "connections": [
      { "source": "node-1", "target": "node-2" },
      { "source": "node-2", "target": "node-3" },
      { "source": "node-3", "target": "node-4" },
      { "source": "node-4", "target": "node-5" }
    ]
  }
}
```

### Generate Shareable Link:

**Same as Agent Export:**
- Upload to cloud
- Generate unique URL
- Configurable expiration
- Password protection option

**Link Format:**
```
https://leblebi.app/workflows/share/w1x2y3z4a5b6
```

### Export as QR Code:

**Considerations:**
- Workflows can be large (many nodes)
- QR code complexity increases with data
- May need to use link-based QR for large workflows

**QR Options:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  Export as QR Code               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  This workflow has 5 nodes.         â”‚
â”‚                                     â”‚
â”‚  Choose QR code type:               â”‚
â”‚                                     â”‚
â”‚  â— Direct QR (embedded data)        â”‚
â”‚    Works offline, smaller workflows â”‚
â”‚                                     â”‚
â”‚  â—‹ Link QR (cloud hosted)           â”‚
â”‚    Works for any size, requires     â”‚
â”‚    internet to import               â”‚
â”‚                                     â”‚
â”‚  [Generate QR Code]                 â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Publish to Community:

**Workflow Template Publishing:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  Publish Workflow                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Publishing "Email Triage"          â”‚
â”‚                                     â”‚
â”‚  Template Name                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Email Triage Workflow        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  Description                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Automatically triage emails, â”‚   â”‚
â”‚  â”‚ classify by priority, and    â”‚   â”‚
â”‚  â”‚ draft replies for approval.  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  Category                           â”‚
â”‚  [Automation                â–¼]      â”‚
â”‚                                     â”‚
â”‚  Tags                               â”‚
â”‚  [email, automation, productivity]  â”‚
â”‚                                     â”‚
â”‚  Preview Image                      â”‚
â”‚  [Upload screenshot]                â”‚
â”‚                                     â”‚
â”‚  â˜‘ Include agent configurations    â”‚
â”‚  â˜‘ I confirm this doesn't contain  â”‚
â”‚     sensitive or malicious content  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   Submit for Review       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Import Workflow:

**Import Preview:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  Import Workflow                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  ğŸ“§ Email Triage                    â”‚
â”‚                                     â”‚
â”‚  Description:                       â”‚
â”‚  Automatically triage emails,       â”‚
â”‚  classify by priority, and draft    â”‚
â”‚  replies for approval.              â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   [Workflow graph preview]   â”‚   â”‚
â”‚  â”‚                              â”‚   â”‚
â”‚  â”‚   T â”€â”€â–¶ A â”€â”€â–¶ A â”€â”€â–¶ âœ“ â”€â”€â–¶ Oâ”‚   â”‚
â”‚  â”‚                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  Nodes: 5                           â”‚
â”‚  Agents: 2 (included)               â”‚
â”‚                                     â”‚
â”‚  âš ï¸ Missing Requirements:           â”‚
â”‚  â€¢ Email account not connected      â”‚
â”‚                                     â”‚
â”‚  Import as:                         â”‚
â”‚  â— New workflow                     â”‚
â”‚  â—‹ Replace existing workflow        â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚    Import Workflow        â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Post-Import Setup:**
If agents excluded or missing requirements:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  Configure Workflow              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Your workflow needs configuration: â”‚
â”‚                                     â”‚
â”‚  Agent Nodes                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Classifier Agent             â”‚   â”‚
â”‚  â”‚ Select an agent:             â”‚   â”‚
â”‚  â”‚ [Choose or create        â–¼]  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Drafting Agent               â”‚   â”‚
â”‚  â”‚ Select an agent:             â”‚   â”‚
â”‚  â”‚ [Choose or create        â–¼]  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  Required Connections               â”‚
â”‚  â˜ Email account (click to setup)  â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   Complete Setup          â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### State Management:

**Workflow Export Data:**
```javascript
{
  format: enum, // json, link, qr, community
  workflowId: string,
  includeAgents: boolean,
  shareSettings: {
    expiration: Date | null,
    password: string | null
  }
}
```

### Validation:
- Validate workflow structure before export
- Check for circular dependencies
- Verify all connections are valid
- Ensure required nodes are present (at least one trigger, one output)

## ZFA Architecture Requirements

### Entity Definition

Uses existing **Workflow** entity (UC-5.1).

**SharedWorkflow Entity:**
```bash
zfa entity create -n SharedWorkflow --field "id:String,workflowId:String,includeAgents:bool,shareLink:String?,expiresAt:DateTime?,downloadCount:int,createdAt:DateTime" --json
```

### Clean Architecture Generation

```bash
zfa generate SharedWorkflow --methods=get,getList,create,delete --data --vpc --state
```

### Implementation Notes

1. **Include Agents**: If true, embed agent configs in export JSON
2. **Structure Validation**: Check node connections before export
3. **Import Preview**: Show workflow graph before confirming import

